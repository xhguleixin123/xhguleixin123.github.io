# 函数

## 调用函数

```python
# 绝对值函数
abs(100)
# 数据类型转换
int('123')
float('12.34')
str(1.23)
bool(1)
```

## 定义函数

```python
# 定义绝对值函数
def my_abs(x):
    if x >= 0:
        return x
    else:
        return -x
# 定义空函数
def nop():
# pass是跳过，什么也不做，现在还没想好该怎么做。
    pass

# 参数检查
def my_abs(x):
	if not isinstance(x,(int, float)):
        raise TypeError('bad operand type')
    if x >= 0:
        return x
    else:
        return -x
# 返回多个值
import math
def move(x, y, step, angle = 0):
    nx = x + step * math.cos(angle)
    ny = y - step * math.sin(angle)
    return nx, ny
```

## 函数的参数

### 位置参数

```python
# 单个位置参数的函数
def power(x):
    return x * x
# 多个位置参数的函数
def power(x, n):
    s = 1
    while n>0:
        s = s * x
        n = n-1
    return s
```

### 默认参数

> 在调用时可以无需调用第二个参数

```python
def power(x, n=2):
    s = 1
    while n > 0:
        s = 1
        n = n - 1
    return s
```

* 调用默认参数存在的问题。

```python
# L指向的[]是一个可变对象，L指向的是[]这个可变对象，每次调用的时候，指向的[]就会改变。
def add_end(L=[]): # 每次调用时，L始终指向同一个[]
    L.append('END')
    return L

# 参数指向不变对象
def add_end(L = None):
    if L is None:
        L = []	# 每次调用时，L重新指向一个[]
    L.append('END')
    return L
```

### 可变参数

* 利用list或tuple在传递不限数量的参数

```python
# 定义函数
def calc(numbers):
    sum = 0
    for n in numbers:
        sum = sum + n * n
    return sum
# 调用函数时，利用list或tuple
calc([1,2,3])
calc((1,2,3))
```

* 利用可变参数来定义函数

```python
# 利用*号来定义可变参数
def calc(*numbers):
    sum = 0
    for n in numbers:
        sum = sum + n * n
    return sum
# 调用时，直接写入参数即可，会传递个numbers一个tuple
calc(1,2,3)
# 将list活着tuple赋值给可变参数
nums = [1,2,3]
calc(*nums) # *是将nums复制给numbers，对number的修改不影响nums。
```

### 关键字参数

```python
# 定义关键词参数函数
def person(name, age, **kv):
    print('name', name, 'age', age, 'other', kv)

# 调用关键词参数
person('Bob', 35, city='Beijing')	# 是将参数以dict的形式复制给kv
# 利用dict来传递参数
extra = ['city':'Beijing', 'job': 'Engineer']
person('Jack', 24, **extra)		# 是将extra复制给kv
```

### 命名关键字参数

```python
# 通过*来隔开，*后面被视为命名关键字参数
def person(name, age, *, city, job):
    print(nmae, age, city, job)

# 如果有一个可变参数，就不需要*来隔开命名关键字参数。
def person(name, age, *args, city, job):
    print(nmae, age, args, city, job)
    
# 关键字参数具有默认值，调用时可以不传入改参数。
def person(name, age, *, city='Beijing', job):
    print(name, age, city, job)
person('Jack', 24, job='Engineer')
```

### 参数组合

> 参数定义顺序：必选参数、默认参数、可变参数、命名关键字参数和关键字参数

```python
def f1(a, b, c=0, *args, **kw):
    print('a =', a, 'b =', b, 'c =', c, 'args =', args, 'kw =', kw)

def f2(a, b, c=0, *, d, **kw):
    print('a =', a, 'b =', b, 'c =', c, 'd =', d, 'kw =', kw)
```

## 递归函数

> 调用函数本身时，包含表达式，会从栈帧中重新申请一个栈帧，到函数结束时，才会释放栈帧，所以会导致栈溢出

```python
# 调用fact时，调用了fact本身。
def fact(n):
    if n==1:
        return 1
    return n * fact(n - 1)
```

* 使用尾递归防止栈溢出

```python
def fact(n):
    return fact_iter(n, 1)
# 函数在调用时，调用的是fact_iter本身的栈，解释器会优化。但python的解释器没有优化。
def fact_iter(num, product):
    if num == 1:
        return product
    return fact_iter(num - 1, num * product)
```

